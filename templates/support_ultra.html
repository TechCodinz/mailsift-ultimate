<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MailSift Ultra - AI Support</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
            min-height: 100vh;
            font-family: 'JetBrains Mono', monospace;
        }
        .cyber-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 255, 255, 0.3);
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 255, 255, 0.1);
        }
        .cyber-button {
            background: linear-gradient(45deg, #00ffff, #0080ff);
            border: none;
            color: #000;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        .cyber-button:hover {
            background: linear-gradient(45deg, #0080ff, #00ffff);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 255, 255, 0.4);
        }
        .glow-text {
            text-shadow: 0 0 10px #00ffff;
        }
        .chat-message {
            animation: fadeInUp 0.5s ease;
        }
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .typing-indicator {
            display: none;
        }
        .typing-indicator.show {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-white glow-text mb-2">ü§ñ AI Support Center</h1>
            <p class="text-cyan-300">Get instant help with our AI-powered support assistant</p>
        </div>

        <!-- Main Support Interface -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- AI Chat Section -->
            <div class="lg:col-span-2 cyber-card p-6">
                <h2 class="text-2xl font-bold text-white mb-4 glow-text">üí¨ AI Assistant Chat</h2>
                
                <!-- Chat Messages -->
                <div id="chat-messages" class="h-96 overflow-y-auto mb-4 p-4 bg-gray-900 rounded-lg border border-cyan-500">
                    <div class="chat-message mb-4">
                        <div class="bg-cyan-600 text-black p-3 rounded-lg inline-block max-w-xs">
                            <div class="font-semibold">MailSift AI</div>
                            <div>Hello! I'm your AI support assistant. I can help you with:</div>
                            <ul class="mt-2 text-sm">
                                <li>üîç Email extraction and validation</li>
                                <li>üí≥ Licensing and payments</li>
                                <li>‚öôÔ∏è Technical support</li>
                                <li>üìä API usage and integration</li>
                            </ul>
                            <div class="mt-2">How can I assist you today?</div>
                        </div>
                    </div>
                </div>

                <!-- Typing Indicator -->
                <div id="typing-indicator" class="typing-indicator mb-4">
                    <div class="bg-gray-700 text-white p-3 rounded-lg inline-block">
                        <div class="flex items-center">
                            <div class="animate-pulse">AI is typing</div>
                            <div class="ml-2 flex space-x-1">
                                <div class="w-2 h-2 bg-cyan-400 rounded-full animate-bounce"></div>
                                <div class="w-2 h-2 bg-cyan-400 rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                                <div class="w-2 h-2 bg-cyan-400 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Chat Input -->
                <div class="flex gap-2">
                    <input type="text" id="chat-input" placeholder="Ask me anything about MailSift..." 
                           class="flex-1 p-3 bg-gray-800 border border-cyan-500 rounded-lg text-white focus:outline-none focus:border-cyan-400"
                           onkeypress="handleKeyPress(event)">
                    <button onclick="sendMessage()" class="cyber-button px-6 py-3 rounded-lg">
                        Send
                    </button>
                </div>

                <!-- Quick Suggestions -->
                <div class="mt-4">
                    <div class="text-gray-300 text-sm mb-2">Quick questions:</div>
                    <div class="flex flex-wrap gap-2">
                        <button onclick="sendQuickMessage('How do I extract emails from a website?')" 
                                class="bg-gray-700 hover:bg-gray-600 px-3 py-1 rounded text-sm text-white">
                            Website extraction
                        </button>
                        <button onclick="sendQuickMessage('What file formats are supported?')" 
                                class="bg-gray-700 hover:bg-gray-600 px-3 py-1 rounded text-sm text-white">
                            File formats
                        </button>
                        <button onclick="sendQuickMessage('How do I purchase a license?')" 
                                class="bg-gray-700 hover:bg-gray-600 px-3 py-1 rounded text-sm text-white">
                            License purchase
                        </button>
                        <button onclick="sendQuickMessage('API rate limits')" 
                                class="bg-gray-700 hover:bg-gray-600 px-3 py-1 rounded text-sm text-white">
                            API limits
                        </button>
                    </div>
                </div>
            </div>

            <!-- Support Options -->
            <div class="space-y-6">
                <!-- Create Support Ticket -->
                <div class="cyber-card p-6">
                    <h3 class="text-xl font-bold text-white mb-4 glow-text">üìù Create Support Ticket</h3>
                    <form id="ticket-form" onsubmit="createTicket(event)">
                        <div class="mb-4">
                            <label class="block text-gray-300 mb-2">Email</label>
                            <input type="email" id="ticket-email" required
                                   class="w-full p-3 bg-gray-800 border border-cyan-500 rounded-lg text-white focus:outline-none focus:border-cyan-400">
                        </div>
                        <div class="mb-4">
                            <label class="block text-gray-300 mb-2">Subject</label>
                            <input type="text" id="ticket-subject" required
                                   class="w-full p-3 bg-gray-800 border border-cyan-500 rounded-lg text-white focus:outline-none focus:border-cyan-400">
                        </div>
                        <div class="mb-4">
                            <label class="block text-gray-300 mb-2">Category</label>
                            <select id="ticket-category"
                                    class="w-full p-3 bg-gray-800 border border-cyan-500 rounded-lg text-white focus:outline-none focus:border-cyan-400">
                                <option value="general">General</option>
                                <option value="technical">Technical</option>
                                <option value="licensing">Licensing</option>
                                <option value="billing">Billing</option>
                            </select>
                        </div>
                        <div class="mb-4">
                            <label class="block text-gray-300 mb-2">Message</label>
                            <textarea id="ticket-message" rows="4" required
                                      class="w-full p-3 bg-gray-800 border border-cyan-500 rounded-lg text-white focus:outline-none focus:border-cyan-400"></textarea>
                        </div>
                        <button type="submit" class="w-full cyber-button py-3 rounded-lg">
                            Create Ticket
                        </button>
                    </form>
                </div>

                <!-- Contact Information -->
                <div class="cyber-card p-6">
                    <h3 class="text-xl font-bold text-white mb-4 glow-text">üìû Contact Info</h3>
                    <div class="space-y-3">
                        <div class="flex items-center">
                            <span class="text-cyan-400 mr-3">üìß</span>
                            <div>
                                <div class="text-white font-semibold">Email Support</div>
                                <div class="text-gray-300 text-sm">support@mailsift.com</div>
                            </div>
                        </div>
                        <div class="flex items-center">
                            <span class="text-cyan-400 mr-3">‚è∞</span>
                            <div>
                                <div class="text-white font-semibold">Response Time</div>
                                <div class="text-gray-300 text-sm">Within 2 hours</div>
                            </div>
                        </div>
                        <div class="flex items-center">
                            <span class="text-cyan-400 mr-3">üåç</span>
                            <div>
                                <div class="text-white font-semibold">Business Hours</div>
                                <div class="text-gray-300 text-sm">24/7 AI Support</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- FAQ -->
                <div class="cyber-card p-6">
                    <h3 class="text-xl font-bold text-white mb-4 glow-text">‚ùì Quick FAQ</h3>
                    <div class="space-y-3">
                        <div class="text-white">
                            <div class="font-semibold">How accurate is email extraction?</div>
                            <div class="text-gray-300 text-sm">99.9% accuracy with AI validation</div>
                        </div>
                        <div class="text-white">
                            <div class="font-semibold">What file formats are supported?</div>
                            <div class="text-gray-300 text-sm">TXT, CSV, HTML, PDF, DOCX, Excel</div>
                        </div>
                        <div class="text-white">
                            <div class="font-semibold">Is there a free tier?</div>
                            <div class="text-gray-300 text-sm">Yes, 100 requests/day</div>
                        </div>
                        <div class="text-white">
                            <div class="font-semibold">How do I get a license?</div>
                            <div class="text-gray-300 text-sm">Purchase with crypto or card</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let sessionId = 'session_' + Date.now();
        let chatMessages = document.getElementById('chat-messages');
        let chatInput = document.getElementById('chat-input');
        let typingIndicator = document.getElementById('typing-indicator');

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        function sendMessage() {
            const message = chatInput.value.trim();
            if (!message) return;

            // Add user message to chat
            addMessageToChat(message, 'user');
            chatInput.value = '';

            // Show typing indicator
            typingIndicator.classList.add('show');

            // Send to AI
            fetch('/api/support/chat', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    session_id: sessionId,
                    message: message
                })
            })
            .then(response => response.json())
            .then(data => {
                typingIndicator.classList.remove('show');
                
                if (data.status === 'success') {
                    addMessageToChat(data.response, 'ai');
                    
                    // Show suggestions if available
                    if (data.suggestions && data.suggestions.length > 0) {
                        showSuggestions(data.suggestions);
                    }
                } else {
                    addMessageToChat('Sorry, I encountered an error. Please try again.', 'ai');
                }
            })
            .catch(error => {
                typingIndicator.classList.remove('show');
                addMessageToChat('Sorry, I\'m having trouble connecting. Please try again.', 'ai');
            });
        }

        function sendQuickMessage(message) {
            chatInput.value = message;
            sendMessage();
        }

        function addMessageToChat(message, sender) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'chat-message mb-4';
            
            if (sender === 'user') {
                messageDiv.innerHTML = `
                    <div class="flex justify-end">
                        <div class="bg-blue-600 text-white p-3 rounded-lg inline-block max-w-xs">
                            <div class="font-semibold">You</div>
                            <div>${message}</div>
                        </div>
                    </div>
                `;
            } else {
                messageDiv.innerHTML = `
                    <div class="bg-cyan-600 text-black p-3 rounded-lg inline-block max-w-xs">
                        <div class="font-semibold">MailSift AI</div>
                        <div>${message}</div>
                    </div>
                `;
            }
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function showSuggestions(suggestions) {
            const suggestionsDiv = document.createElement('div');
            suggestionsDiv.className = 'mt-2';
            suggestionsDiv.innerHTML = '<div class="text-gray-300 text-sm mb-2">Suggested questions:</div>';
            
            const buttonsDiv = document.createElement('div');
            buttonsDiv.className = 'flex flex-wrap gap-2';
            
            suggestions.slice(0, 3).forEach(suggestion => {
                const button = document.createElement('button');
                button.className = 'bg-gray-700 hover:bg-gray-600 px-3 py-1 rounded text-sm text-white';
                button.textContent = suggestion;
                button.onclick = () => sendQuickMessage(suggestion);
                buttonsDiv.appendChild(button);
            });
            
            suggestionsDiv.appendChild(buttonsDiv);
            chatMessages.appendChild(suggestionsDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function createTicket(event) {
            event.preventDefault();
            
            const formData = {
                email: document.getElementById('ticket-email').value,
                subject: document.getElementById('ticket-subject').value,
                message: document.getElementById('ticket-message').value,
                category: document.getElementById('ticket-category').value
            };
            
            fetch('/api/support/ticket', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(formData)
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    alert(`Ticket created successfully! Ticket ID: ${data.ticket_id}\n\nAI Response: ${data.ai_response}`);
                    document.getElementById('ticket-form').reset();
                } else {
                    alert('Error creating ticket: ' + data.error);
                }
            })
            .catch(error => {
                alert('Error creating ticket. Please try again.');
            });
        }
    </script>
</body>
</html>
